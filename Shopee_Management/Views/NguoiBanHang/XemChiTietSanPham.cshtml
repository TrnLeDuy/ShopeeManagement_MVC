@model IEnumerable<Shopee_Management.Models.SANPHAM>
@using Shopee_Management.Controllers
@{
    ViewBag.Title = "XemChiTietSanPham";
    Layout = "~/Views/Shared/_KenhBanHangLayout.cshtml";
    var sanPhamList = (List<Shopee_Management.Models.SANPHAM>)ViewBag.SanPhamList;
    var nbhList = (List<Shopee_Management.Models.NGUOIBANHANG>)ViewBag.NBHList;
    var sizeList = (List<Shopee_Management.Models.KICHCO>)ViewBag.SizeList;
    var colorList = (List<Shopee_Management.Models.BANGMAU>)ViewBag.ColorList;
    var brandList = (List<Shopee_Management.Models.THUONGHIEU>)ViewBag.BrandList;
    var memberList = (List<Shopee_Management.Models.XUATXU>)ViewBag.MemberList;
    var nganhhangList = (List<Shopee_Management.Models.NGANHHANG>)ViewBag.NganhHangList;
    var nhconList = (List<Shopee_Management.Models.NGANHHANGCON>)ViewBag.NganhHangConList;
    var nhc3List = (List<Shopee_Management.Models.NGANHHANGCAP3>)ViewBag.NganhHangC3List;
    string key = Request.QueryString["key"];
    List<Shopee_Management.Models.SANPHAM> result = new List<Shopee_Management.Models.SANPHAM>();
}
<head>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<div class="section__content section__content--p30">
    <div class="container-fluid">
        <div class="ManagerInfo" style="margin-bottom:25px;">
            <table>
                <tr>
                    <td colspan="14"></td>
                    <td class="control" colspan="3">
                        <a style="width:100%" href=""></a>
                    </td>
                    <td class="control">
                        <a href="~/NguoiBanHang/ThemCTSP" style="margin-bottom: 20px; background-color: #0ab618;color:white" class="btn btn--add">Thêm Chi Tiết Sản Phẩm</a>
                    </td>
                    <td></td>
                </tr>
            </table>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive table--no-card m-b-30">
                    <table class="table table-borderless table-striped table-earning">
                        <thead>
                            <tr>
                                <th>Tên sản phẩm</th>
                                <th>Kích cỡ</th>
                                <th>Màu</th>
                                <th>Thương hiệu</th>
                                <th>Xuất xứ</th>
                                <th>Ngành hàng</th>
                                <th>Ngành hàng con</th>
                                <th>Ngành hàng cấp 3</th>
                                <th>Số lượng</th>
                                <th>Cập nhật</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in ViewBag.ChiTietSPList)
                            {
                                var sanPham = sanPhamList.FirstOrDefault(p => p.id_sp == item.id_sp);
                                // var nbh = nbhList.FirstOrDefault(p => p.id_nbh == item.id_nbh);
                                var kichco = sizeList.FirstOrDefault(p => p.id_size == item.id_size);
                                var mau = colorList.FirstOrDefault(p => p.id_color == item.id_color);
                                var thuonghieu = brandList.FirstOrDefault(p => p.id_brand == item.id_brand);
                                var xuatxu = memberList.FirstOrDefault(p => p.id_member == item.id_member);
                                var nganhhang = nganhhangList.FirstOrDefault(p => p.id_nganhhang == item.id_nganhhang);
                                var nhc = nhconList.FirstOrDefault(p => p.id_nhcon == item.id_nhcon);
                                var nhc3 = nhc3List.FirstOrDefault(p => p.id_nhc3 == item.id_nhc3);

                                if (sanPham != null)
                                {
                                    <tr>
                                        <td>@sanPham.ten_sp</td>
                                        <td>@(kichco != null ? kichco.ten_size : "N/A")</td>
                                        <td>@(mau != null ? mau.ten_mau : "N/A")</td>
                                        <td>@(thuonghieu != null ? thuonghieu.ten_brand : "N/A")</td>
                                        <td>@(xuatxu != null ? xuatxu.ten_member : "N/A")</td>
                                        <td>@(nganhhang != null ? nganhhang.ten_nganhhang : "N/A")</td>
                                        <td>@(nhc != null ? nhc.ten_nhcon : "N/A")</td>
                                        <td>@(nhc3 != null ? nhc3.ten_nhc3 : "N/A")</td>
                                        <td>@item.so_luong</td>
                                        <td>
                                            <button class="edit-product-details" data-id="@item.id_ctsp">Cập nhật</button>
                                        </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

    </div>
</div>
<script>
    $(".edit-product-detaill").click(function () {
        var productId = $(this).data("id");
        window.location.href = '/NguoiBanHang/CapNhatCTSP/' + productId;
    });
    $(".edit-product-details").click(function () {
        var productId = $(this).data("id");
        window.location.href = '/NguoiBanHang/CapNhatCTSP/' + productId;
    });
</script>